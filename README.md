This repository contains public code for the manuscript:

Zou, Heng-Xing, Xinyi Yan, and Volker HW Rudolf. 2023. "Time-dependent Interaction Modification Generated from Plant-soil Feedback." *bioRXiv*. [https://doi.org/10.1101/2023.11.03.565336](https://doi.org/10.1101/2023.11.03.565336)

For any questions, please [contact Heng-Xing Zou](hengxingzou@rice.edu)

# Abstract

Pairwise interactions between species can be modified by other community members, leading to emergent dynamics that are contingent on the composition of a community. Despite the prevalence of such higher-order interactions, little is known about how they are linked to the timing and order of species’ arrival. Yet, these temporal patterns typically affect their pairwise interactions (i.e., priority effects) and thus could also modify higher-order interactions in multispecies communities. Here, we first develop a general framework of time-dependent interaction modifications by building on pairwise priority effects. By applying this framework to data generated by a mechanistic plant-soil feedback model, we show that how pairwise interactions are modified by a third plant depends on the relative sequence and spacing of plants’ germination phenology. This time-dependence of interaction modifications emerges from concurrent changes in plant and microbe populations and they become stronger with a higher overlap between plants’ associated microbiomes. We discuss how processes in the plant-soil feedback model represent a wide range of mechanisms applicable in other systems from which similar time-dependent interaction modifications can emerge. Our results highlight the need to integrate temporal shifts of species interactions to predict the emergent dynamics of natural communities.

# Code Files

All simulations were run in R version 4.2.1.

- `Functions_PSF.R` contains all functions used for contructing the plant-soil feedback model.
- `GenerateData.R` contains code for generating data using the mechanistic plant-soil feedback model.
- `GenerateData_MultipleParams.R` contains code for generating data using randomly selected parameters; this is required for the sensitivity analysis (see Appendix of the manuscript).
- `ModelFitting.R` contains all code for fitting the simulated data to phenomenological models of higher-order interactions.
- `Analysis.Rmd` contains code for creating all figures in the main text and Appendix.

# Data

- `SavedMetacoms` contains initial metacommunities in `.csv` files. You can also generate metacommunities in `FiguresReadMe.Rmd`, but resulting figures will likely be different because of the random generation process. 
- `Dec17_5spp.RData` contains generated data from all simulations in the main text. This is a pre-packaged R dataset that includes all variables in the environment. To load the dataset, simply double click while `Functions_SpatialBH.R` and `FiguresReadMe.Rmd` are opened in RStudio. Loading `Dec17_5spp.RData` will load the following key datasets:
  * **Metacommunities (2 data frames)**: `M_1` and `M_2`. See `SavedMetacoms`.
  * **Population dynamics (4 data frames)**: `lowdisp_1`, `lowdisp_2`, `highdisp_1`, `highdisp_2`. Thess are population dynamics of all patches and all repetitions. `low` or `high` denotes low or high dispersal rates. `_1` and `_2` denote scenarios (1. Equal Initials; 2. First Colonizer). They contain scenarios with and without trait-dependent priority effects.
  * **Dispersal-diversity relationships (2 data frames)**: `all_Sce1`, `all_Sce2`. These contain alpha, beta and gamma diversity under a range of dispersal rates of all repetitions. `Sce1` and `Sce2` refer to scenarios (1. Equal Initials; 2. First Colonizer). They contain scenarios with and without trait-dependent priority effects.
  * **Dispersal-diversity relationships at different variations (6 data frames)**: `all_lowvar_1`, `all_lowvar_2`, `all_midvar_1`, `all_midvar_2`, `all_highvar_1`, `all_highvar_2`. These contain alpha, beta and gamma diversity under a range of dispersal rates, three different variations of emergence times, and of all repetitions. `lowvar`, `midvar`, and `highvar` denote the magnitude of variations. `_1` and `_2` denote scenarios (1. Equal Initials; 2. First Colonizer). They contain scenarios with and without trait-dependent priority effects.

# Reproducing Figures

- Unarchive the provided `SavedMetacoms.zip`.
- Make sure all files, including the `SavedMetacoms` folder, are under the same directory.
- Open `FiguresReadMe.Rmd`, then load `Dec17_5spp.RData`.
- Follow specific instructions in `FiguresReadMe.Rmd` to generate figures in the main text, or change model parameters to produce figures in the appendix.
